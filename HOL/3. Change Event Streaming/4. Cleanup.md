# Cleanup

A database cannot be dropped if it has active streaming groups and objects. So in order to clean up your environment, you need to first remove the tables from the streaming group, drop the stream group, and then delete the database.

## Remove tables from the CES Stream Group

```sql
EXEC sys.sp_remove_object_from_event_stream_group 'SqlCesGroup', 'dbo.Product'
EXEC sys.sp_remove_object_from_event_stream_group 'SqlCesGroup', 'dbo.Customer'
EXEC sys.sp_remove_object_from_event_stream_group 'SqlCesGroup', 'dbo.Order'
EXEC sys.sp_remove_object_from_event_stream_group 'SqlCesGroup', 'dbo.OrderDetail'
EXEC sys.sp_remove_object_from_event_stream_group 'SqlCesGroup', 'dbo.TableWithNoPK'
```

## Drop CES Stream Group

This statement drops the stream group and all associated table bindings.

```sql
EXEC sys.sp_drop_event_stream_group 'SqlCesGroup'
```

## Disable Change Event Streaming

```sql
EXEC sys.sp_disable_event_stream
```

## Delete the Database

```sql
USE master
GO

ALTER DATABASE CesDemo_firstname_lastname SET SINGLE_USER WITH ROLLBACK IMMEDIATE

-- Drop the database
DROP DATABASE CesDemo_firstname_lastname
```
