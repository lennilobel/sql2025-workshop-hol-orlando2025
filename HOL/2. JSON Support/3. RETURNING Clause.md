## Type-Safe Extraction with `RETURNING` Clause

The `RETURNING` clause on `JSON_VALUE` lets you specify a SQL type for the extracted scalar—improving correctness and plan quality compared with wrapping the function in an external `CAST/CONVERT`. It is **ANSI‑compliant** and avoids surprises with string comparisons.

**Why this matters:** `JSON_VALUE` traditionally returns a string type. Comparing that to a number uses string semantics (e.g., `'100' < '9'`), which results in an error. For example, retrieving customers with a balance greater than $50:

```sql
SELECT * FROM Customer WHERE JSON_VALUE(CustomerJson, '$.balance') > 50
```

You can see that this fails because the `>` operator cannot compare the string returned by `JSON_VALUE` to a numeric type. Instead, you must coerce to a numeric type to get proper numeric comparisons. The new `RETURNING` clause bakes this coercion into the extraction:

```sql
SELECT * FROM Customer WHERE JSON_VALUE(CustomerJson, '$.balance' RETURNING int) > 50
```

___

▶ [Lab: Native JSON Indexes](https://github.com/lennilobel/sql2025-workshop-hol-orlando2025/blob/main/HOL/2.%20JSON%20Support/4.%20Native%20JSON%20Indexes.md)
